%% 根据设定的a_hcp和c_hcp计算得到新的原子半径和数量

function [radius, N] = cal_hcp_radius(a_hcp, c_hcp, r_cut)
% a_hcp，c_hcp为HCP相的晶格常数，r_cut为势函数的截断半径
alpha_hcp{1} = [1.000000000000, 1.732050807569, 2.000000000000, 2.645751311065, 3.000000000000, 3.464101615138];
N_hcp{1} = [6, 6, 6, 12, 6, 6];
alpha_hcp{2} = [0.577350269190, 1.154700538379, 1.527525231652, 2.081665999466, 2.309401076759, 2.516611478424, 2.886751345948, 3.055050463304, 3.214550253664, 3.511884584284];
N_hcp{2} = [6, 6, 12, 12, 6, 12, 6, 12, 12, 12];
alpha_hcp{3} = [0.000000000000, 1.000000000000, 1.732050807569, 2.000000000000, 2.645751311065, 3.000000000000, 3.464101615138];
N_hcp{3} = [2, 12, 12, 12, 24, 12, 12];
alpha_hcp{4} = [0.577350269190, 1.154700538379, 1.527525231652, 2.081665999466, 2.309401076759, 2.516611478424, 2.886751345948, 3.055050463304, 3.214550253664];
N_hcp{4} = [6, 6, 12, 12, 6, 12, 6, 12, 12];
alpha_hcp{5} = [0.000000000000, 1.000000000000, 1.732050807569, 2.000000000000, 2.645751311065, 3.000000000000];
N_hcp{5} = [2, 12, 12, 12, 24, 12];
alpha_hcp{6} = [0.577350269190, 1.154700538379, 1.527525231652, 2.081665999466, 2.309401076759, 2.516611478424, 2.886751345948];
N_hcp{6} = [6, 6, 12, 12, 6, 12, 6];
alpha_hcp{7} = [0.000000000000, 1.000000000000, 1.732050807569, 2.000000000000];
N_hcp{7} = [2, 12, 12, 12];
alpha_hcp{8} = [0.577350269190, 1.154700538379, 1.527525231652, 2.081665999466];
N_hcp{8} = [6, 6, 12, 12];
alpha_hcp{9} = [0.000000000000, 1.000000000000];
N_hcp{9} = [2, 12];
length = 55;

h_cal = c_hcp/2;

radius = zeros(1, length);
N = zeros(1, length);
input_idx = 1;
for i = 1:size(alpha_hcp, 2)
    this_length = size(alpha_hcp{i}, 2);     % 该项长度
    radius(input_idx:input_idx+this_length-1) = sqrt((alpha_hcp{i}*a_hcp).^2 + ((i-1)*h_cal)^2);
    N(input_idx:input_idx+this_length-1) = N_hcp{i};
    input_idx = input_idx + this_length;
end

idx = radius < r_cut;
radius = radius(idx);
N = N(idx);
end